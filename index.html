<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>LCARS Self-Destruct Console v5.2</title>
<style>
:root{
  --bg:#070709;--text:#eef3ff;--muted:#9fb0c9;--line:#262a34;
  --lcars-amber:#ffb400;--lcars-red:#ff3b3b;
  --ok:#2be4a1;--warn:#ffb400;--alert:#ff4b4b;
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--text);font-family:ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial}
header{position:sticky;top:0;z-index:20;padding:10px 14px;background:linear-gradient(180deg,#0e1118,#0a0c11);border-bottom:2px solid var(--line)}
.lcars{display:flex;align-items:center;gap:14px}
.lcars .bar{height:24px;width:160px;border-radius:12px 0 0 12px;background:var(--lcars-amber)}
.lcars .bar2{height:24px;width:110px;border-radius:0 12px 12px 0;background:var(--lcars-red)}
.title{letter-spacing:.28em;text-transform:uppercase;font-weight:900}
.tabs{margin-left:auto;display:flex;gap:8px}
.tab{cursor:pointer;padding:12px 16px;border:2px solid var(--line);background:#131722;border-radius:999px;color:#dde7ff;font-weight:800;letter-spacing:.08em}
.tab.active{background:linear-gradient(90deg,#2a0000,#4a0000);border-color:#a22;color:#fff}
main{max-width:1200px;margin:0 auto;padding:22px}

/* COUNTDOWN view */
#viewCountdown{display:grid;grid-template-columns:1fr;gap:18px}
.centerCard{background:linear-gradient(180deg,#161b28,#111621);border:1px solid #202c3d;border-radius:18px;padding:22px;display:flex;flex-direction:column;align-items:center;text-align:center;box-shadow:0 10px 30px rgba(0,0,0,.35)}
.centerCard h2{margin:0 0 12px;letter-spacing:.12em;text-transform:uppercase}
.statusRow{display:flex;gap:12px;align-items:center;justify-content:center;flex-wrap:wrap}
.pill{padding:6px 14px;border-radius:999px;font-weight:900;letter-spacing:.1em}
.idle{background:#0b241a;color:var(--ok);border:1px solid #1b5c44}
.armed{background:#241f0b;color:var(--warn);border:1px solid #6b560d}
.countdown{background:#2a0b0b;color:var(--alert);border:1px solid #6b2323}
.aborted{background:#1e1e1e;color:#cfcfcf;border:1px solid #3a3a3a}
.detonated{background:#360909;color:#ff9b9b;border:1px solid #833}
.k{color:#9fb0c9;text-transform:uppercase;letter-spacing:.12em;font-size:13px}
.timer{display:flex;flex-direction:column;align-items:center;gap:10px;margin-top:14px}
.big{font-variant-numeric:tabular-nums;font-size:96px;line-height:1;letter-spacing:.04em}
.sub{color:#9fb0c9;font-size:14px}
.bar{height:18px;background:#101827;border:1px solid #1f2d44;border-radius:999px;overflow:hidden;width:min(900px,92vw);margin-top:12px}
.bar>div{height:100%;width:0%;background:linear-gradient(90deg,var(--ok),var(--warn),var(--alert));transition:width .2s linear}
.log{font-family:ui-monospace,Menlo,Consolas,monospace;background:#0b0f18;border:1px solid #1b2740;border-radius:14px;padding:12px;height:220px;overflow:auto}
.flash{animation:flash .8s steps(4) infinite}
@keyframes flash{50%{opacity:.35}}

/* CONTROL view */
#viewControl{display:none;grid-template-columns:1fr 1fr;gap:18px}
.card{background:linear-gradient(180deg,#161b28,#111621);border:1px solid #202c3d;border-radius:18px;padding:18px}
.card h2{margin:0 0 12px;letter-spacing:.12em;text-transform:uppercase}
.two{display:grid;grid-template-columns:1fr 1fr;gap:12px}
input{background:#0f1421;border:1px solid #203049;color:#eaf2ff;padding:12px;border-radius:12px;width:100%}
label{display:block;font-size:12px;color:#9fb0c9;margin-bottom:6px}
button{cursor:pointer;padding:12px 14px;border-radius:12px;border:1px solid #2a3b56;background:#0f1623;color:#e6eefb;font-weight:800}
button.primary{border-color:#21d39e}
button.warn{border-color:#ffb400}
button.danger{border-color:#ff3b3b}
.footer{margin:28px 0 50px;text-align:center;color:#9fb0c9;font-size:12px}

/* access gate */
.overlay{position:fixed;inset:0;background:radial-gradient(1000px 600px at 40% -10%,rgba(255,59,59,.12),transparent), rgba(0,0,0,.9);display:none;align-items:center;justify-content:center;z-index:30}
.gate{width:min(520px,92vw);background:#0b0f14;border:2px solid #330;border-radius:16px;padding:18px}
.gate h3{margin:0 0 6px;text-transform:uppercase;letter-spacing:.2em;color:#ff9b9b}
.denied{color:#ff9b9b;font-weight:900;letter-spacing:.18em;text-transform:uppercase}

/* alerts */
#globalAlert{position:fixed;inset:0;display:none;z-index:10000;
  background:
  radial-gradient(1200px 700px at 30% -10%, rgba(255,0,0,.18), transparent),
  radial-gradient(1200px 700px at 70% 110%, rgba(255,0,0,.12), transparent),
  repeating-linear-gradient(90deg, rgba(255,0,0,.08) 0 6px, transparent 6px 12px),
  rgba(10,0,0,.92);backdrop-filter:blur(2px);
  align-items:center;justify-content:center}
#globalAlert .msg{font-family:inherit;text-transform:uppercase;letter-spacing:.18em;text-align:center;font-weight:900;line-height:1.1;
  font-size:clamp(32px,7vw,120px);color:#ff6b6b;
  text-shadow:0 0 8px #ff2a2a,0 0 18px #ff2a2a,0 0 36px #ff2a2a,0 0 60px rgba(255,0,0,.45);
  animation:alarmPulse 1.2s ease-in-out infinite,alarmGlow 2.4s ease-in-out infinite}
#globalAlert .sub{margin-top:14px;font-size:clamp(12px,1.6vw,18px);color:#ffb3b3;opacity:.9;letter-spacing:.14em}
@keyframes alarmPulse{0%{opacity:.35}50%{opacity:1}100%{opacity:.35}}
@keyframes alarmGlow{0%{text-shadow:0 0 8px #ff2a2a,0 0 18px #ff2a2a,0 0 36px #ff2a2a,0 0 60px rgba(255,0,0,.45)}
50%{text-shadow:0 0 12px #ff3f3f,0 0 24px #ff3f3f,0 0 48px #ff3f3f,0 0 80px rgba(255,0,0,.6)}
100%{text-shadow:0 0 8px #ff2a2a,0 0 18px #ff2a2a,0 0 36px #ff2a2a,0 0 60px rgba(255,0,0,.45)}}
#topBanner{position:fixed;left:0;right:0;top:54px;z-index:25;padding:10px 16px;text-align:center;font-weight:900;letter-spacing:.18em;text-transform:uppercase;border-bottom:2px solid #300;background:#1a0000;color:#ff9b9b;display:none}
#cornerToasts{position:fixed;right:12px;bottom:12px;z-index:9999;display:flex;flex-direction:column;gap:8px}
.toast{background:#220;border:1px solid #933;color:#fbb;padding:8px 10px;border-radius:10px;font-weight:800;letter-spacing:.1em;text-transform:uppercase}
</style>
</head>
<body>
<header>
  <div class="lcars">
    <div class="bar"></div><div class="bar2"></div>
    <div class="title">LCARS // SELF-DESTRUCT CONSOLE</div>
    <div class="tabs">
      <button class="tab active" id="tabCountdown">COUNTDOWN</button>
      <button class="tab" id="tabControl">CONTROL</button>
    </div>
  </div>
</header>

<div id="topBanner">SELF DESTRUCT SYSTEM DAMAGED — OFFLINE</div>
<div id="globalAlert"><div class="msg"><span id="alarmMain">ALERT</span><div id="alarmSub" class="sub"></div></div></div>
<div id="cornerToasts"></div>

<!-- CONTROL gate -->
<div id="gateOverlay" class="overlay">
  <div class="gate">
    <h3>ACCESS CONTROL</h3>
    <div class="denied" id="gateLabel">ACCESS DENIED</div>
    <div class="two" style="margin-top:6px">
      <div>
        <label for="pin">Operator PIN</label>
        <input id="pin" type="password" placeholder="Enter PIN" autocomplete="current-password"/>
      </div>
      <div style="display:flex;gap:8px;align-items:end">
        <button id="btnUnlock" class="primary">Unlock</button>
        <button id="btnSetPin">Set PIN</button>
      </div>
    </div>
  </div>
</div>

<main>
  <!-- COUNTDOWN VIEW -->
  <div id="viewCountdown">
    <section class="centerCard">
      <h2>SELF-DESTRUCT STATUS</h2>
      <div class="statusRow">
        <span class="k">STATE</span><span id="statusPill" class="pill idle">IDLE</span>
        <span class="k">SINCE</span><span id="since">–</span>
      </div>
      <div class="timer">
        <div class="k">TIME REMAINING</div>
        <div id="timeLeft" class="big">00:00</div>
        <div class="bar"><div id="barFill"></div></div>
        <div class="sub" id="countdownInfo">—</div>
      </div>
      <div style="margin-top:10px;display:flex;gap:12px;justify-content:center;align-items:center">
        <button id="btnToggleSound">Enable Sound</button>
        <label style="font-size:12px;color:#9fb0c9"><input id="chkTick" type="checkbox" checked> tick each second</label>
      </div>
    </section>

    <section class="card" style="max-width:min(980px,92vw);margin:0 auto">
      <h2>EVENT LOG</h2>
      <div id="log" class="log"></div>
    </section>
  </div>

  <!-- CONTROL VIEW -->
  <div id="viewControl">
    <section class="card" id="operatorCard">
      <h2>OPERATOR DEVICE</h2>
      <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap">
        <div><span class="k">UID</span> <code id="uidVal">—</code></div>
        <div class="pill" style="padding:4px 10px" id="opStatus">VIEWER DEVICE</div>
        <button id="btnCopyUid">Copy UID</button>
        <button id="btnSetAsOperator">Set this device as operator</button>
        <button id="btnResetOperator" class="danger">Reset operator (set null)</button>
      </div>
      <p class="muted" style="margin-top:6px;color:#9fb0c9">Only the current operator device can reset. After reset, the next signed-in device can claim operator.</p>
    </section>

    <section class="card" id="rekeyCard">
      <h2>REKEY OFFICERS (BREAK-GLASS)</h2>
      <div class="two">
        <div><label>Operator PIN</label><input id="rkPin" type="password" placeholder="••••"/></div>
        <div><label>Recovery Token</label><input id="rkToken" type="password" placeholder="Paste long token"/></div>
      </div>
      <div style="display:flex;gap:8px;margin-top:10px;flex-wrap:wrap">
        <button id="btnGenToken">Generate token</button>
        <button id="btnSetRecovery" class="warn">Set / Rotate Recovery Token</button>
        <button id="btnRekey" class="danger">Rekey Officers</button>
      </div>
      <p class="muted" style="margin-top:6px;color:#9fb0c9">Token is single-use; only the hash is stored.</p>
    </section>

    <section class="card" id="officerSetupSection">
      <h2>OFFICERS — ONE-TIME SETUP</h2>
      <div class="two">
        <div><label>Officer 1 Name</label><input id="setupO1Name" placeholder="Name"/></div>
        <div><label>Officer 1 PIN</label><input id="setupO1Pin" type="password" placeholder="••••"/></div>
      </div>
      <div class="two" style="margin-top:8px">
        <div><label>Officer 2 Name</label><input id="setupO2Name" placeholder="Name"/></div>
        <div><label>Officer 2 PIN</label><input id="setupO2Pin" type="password" placeholder="••••"/></div>
      </div>
      <div style="display:flex;gap:8px;margin-top:12px">
        <button id="btnSaveOfficers" class="warn">Save Officers</button>
      </div>
    </section>

    <section class="card" id="officerLockedMsg" style="display:none">
      <h2>OFFICERS</h2><p>SET & LOCKED</p>
    </section>

    <section class="card">
      <h2>ARMING — VERIFY</h2>
      <div class="two">
        <div><label>Officer 1 Name</label><input id="verifyO1Name" placeholder="Enter O1 name"/></div>
        <div><label>Officer 1 PIN</label><input id="verifyO1Pin" type="password" placeholder="••••"/></div>
      </div>
      <div class="two" style="margin-top:8px">
        <div><label>Officer 2 Name</label><input id="verifyO2Name" placeholder="Enter O2 name"/></div>
        <div><label>Officer 2 PIN</label><input id="verifyO2Pin" type="password" placeholder="••••"/></div>
      </div>
      <div style="display:flex;gap:8px;margin-top:10px">
        <button id="btnArm" class="warn">Arm</button>
        <button id="btnDisarm">Disarm</button>
      </div>
    </section>

    <section class="card">
      <h2>COUNTDOWN</h2>
      <div class="two">
        <div><label>Minutes</label><input id="mins" type="number" min="0" value="10"/></div>
        <div><label>Seconds</label><input id="secs" type="number" min="0" max="59" value="0"/></div>
      </div>
      <div style="display:flex;gap:8px;margin-top:12px">
        <button id="btnStart" class="primary">Start (MARK)</button>
        <button id="btnAbort" class="danger">Abort</button>
        <button id="btnReset">Reset</button>
      </div>
    </section>
  </div>

  <div class="footer">LCARS single-file · Firebase Realtime DB · Operator-gated control · Countdown public</div>
</main>

<script type="module">
import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js';
import { getDatabase, ref, child, onValue, update } from 'https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js';
import { getAuth, signInAnonymously, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js';

const firebaseConfig = {
  apiKey: "AIzaSyCbXxL7mv9U10MxYkdNsVQrijrpsVGoGU0",
  authDomain: "self-destruct-console.firebaseapp.com",
  databaseURL: "https://self-destruct-console-default-rtdb.europe-west1.firebasedatabase.app/",
  projectId: "self-destruct-console",
  storageBucket: "self-destruct-console.firebasestorage.app",
  messagingSenderId: "669939099742",
  appId: "1:669939099742:web:310269ae940dd68a84accf"
};

/* ----- utils ----- */
const $=s=>document.querySelector(s);
const now=()=>Date.now();
const pad2=n=>String(n).padStart(2,'0');
const fmt=ms=>{ if(ms<0) ms=0; const t=Math.floor(ms/1000),h=Math.floor(t/3600),m=Math.floor((t%3600)/60),s=t%60; return (h?pad2(h)+':':'')+pad2(m)+':'+pad2(s); };

/* ----- alert UI (robust) ----- */
(function css(){
  const s=document.createElement('style');
  s.textContent=`
    body.bricked header, body.bricked main { filter: blur(1px) grayscale(.5) brightness(.7); pointer-events:none; user-select:none; }
    #globalAlert{position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:10000;background:
      radial-gradient(1200px 700px at 30% -10%, rgba(255,0,0,.15), transparent),
      radial-gradient(1200px 700px at 70% 110%, rgba(255,0,0,.12), transparent),
      rgba(10,0,0,.92)}
    #globalAlert .m{color:#ff8080;font-weight:900;text-transform:uppercase;letter-spacing:.18em;text-align:center}
    #globalAlert .t1{font-size:clamp(28px,7vw,120px);text-shadow:0 0 20px #f22}
    #globalAlert .t2{margin-top:10px;font-size:clamp(12px,1.6vw,18px);color:#ffb3b3}
    #topBanner{position:fixed;left:0;right:0;top:0;display:none;z-index:9999;padding:10px 16px;text-align:center;border-bottom:2px solid #300;background:#1a0000;color:#ff9b9b;font-weight:900;letter-spacing:.18em;text-transform:uppercase}
  `;
  document.head.appendChild(s);
})();
function ensureAlert(){
  if(!$('#globalAlert')){
    const d=document.createElement('div'); d.id='globalAlert';
    d.innerHTML=`<div class="m"><div id="alarmMain" class="t1">ALERT</div><div id="alarmSub" class="t2"></div></div>`;
    document.body.appendChild(d);
  }
  if(!$('#topBanner')){
    const b=document.createElement('div'); b.id='topBanner'; b.textContent='ALERT'; document.body.prepend(b);
  }
}
ensureAlert();
let mustShow=false, currentKind='none';
function brickUI(on){
  document.body.classList.toggle('bricked', on);
  const toggle = (el, on) => {
    if(!el) return;
    if(on){
      el.setAttribute('inert','');
      el.querySelectorAll('input,button,select,textarea').forEach(x=>{x.setAttribute('disabled','true');x.setAttribute('tabindex','-1');x.setAttribute('aria-disabled','true');});
    } else {
      el.removeAttribute('inert');
      el.querySelectorAll('[disabled]').forEach(x=>{x.removeAttribute('disabled');x.removeAttribute('tabindex');x.removeAttribute('aria-disabled');});
    }
  };
  toggle($('header'), on); toggle($('main'), on);
}
function showAlert(kind, main, sub){
  ensureAlert(); mustShow=true; currentKind=kind||'generic';
  $('#alarmMain').textContent = main || 'ALERT';
  $('#alarmSub').textContent  = sub  || '';
  $('#globalAlert').style.display='flex';
  $('#topBanner').textContent = main || 'ALERT';
  $('#topBanner').style.display='block';
  brickUI(true);
}
function clearAlert(){
  ensureAlert(); mustShow=false; currentKind='none';
  $('#globalAlert').style.display='none';
  $('#topBanner').style.display='none';
  brickUI(false);
}
new MutationObserver(()=>{ if(mustShow && !$('#globalAlert')) showAlert(currentKind, $('#alarmMain')?.textContent||'ALERT', $('#alarmSub')?.textContent||''); })
  .observe(document.body,{childList:true,subtree:false});

/* ----- health flags ----- */
let connected=false, authed=false, bootOK=false;
let DEBUG_FLAG=true;
let lockoutUntil=0, lockoutReason='';

/* NEW: operator capability probe (sticky access-denied) */
let operatorCapable=false;         // becomes true only after canary succeeds
let deniedSticky=true;             // start “denied” until proven otherwise
let probeTimer=null;

/* ----- public UI refs ----- */
const statusPill=$('#statusPill'), sinceEl=$('#since'), timeLeftEl=$('#timeLeft'), barFill=$('#barFill'), infoEl=$('#countdownInfo'), logEl=$('#log');
let publicState={status:'IDLE',since:0,startAt:null,durationMs:0,armedAt:null,logPublic:[]};
function render(){
  const s=publicState.status||'IDLE';
  if(statusPill){ statusPill.textContent=s; statusPill.className='pill '+s.toLowerCase(); }
  if(sinceEl) sinceEl.textContent = publicState.since ? new Date(publicState.since).toLocaleString() : '–';
  if(s==='COUNTDOWN'){
    const left=(publicState.startAt||0)+(publicState.durationMs||0)-now();
    if(timeLeftEl){ timeLeftEl.textContent=fmt(left); timeLeftEl.classList.toggle('flash', left<=30000); }
    if(barFill && publicState.durationMs>0){ barFill.style.width=Math.max(0,Math.min(100,Math.round(100*(1-left/publicState.durationMs))))+'%'; }
    if(infoEl) infoEl.textContent=`${Math.floor((publicState.durationMs||0)/60000)}m ${pad2(Math.floor((publicState.durationMs||0)/1000)%60)}s from ${new Date(publicState.startAt||0).toLocaleTimeString()}`;
  }else if(s==='ARMED'){
    if(timeLeftEl){ timeLeftEl.textContent='— — : — —'; timeLeftEl.classList.remove('flash'); }
    if(barFill) barFill.style.width='0%';
    if(infoEl) infoEl.textContent='Awaiting MARK';
  }else if(s==='DETONATED'){
    if(timeLeftEl){ timeLeftEl.textContent='00:00'; timeLeftEl.classList.remove('flash'); }
    if(barFill) barFill.style.width='100%';
  }else{
    if(timeLeftEl){ timeLeftEl.textContent='00:00'; timeLeftEl.classList.remove('flash'); }
    if(barFill) barFill.style.width='0%';
    if(infoEl) infoEl.textContent='—';
  }
  if(logEl) logEl.innerHTML=(publicState.logPublic||[]).slice().reverse().join('\n');
}

/* ----- orchestrator ----- */
function recomputeAlert(){
  if(lockoutUntil && now()<lockoutUntil){
    const secs=Math.max(0,Math.ceil((lockoutUntil-now())/1000));
    showAlert('lockout','TERMINAL LOCKOUT',`${lockoutReason||'Security cooldown'} · ${secs}s remaining`);
    return;
  }
  if(!connected){
    showAlert('offline','SELF DESTRUCT SYSTEM DAMAGED — OFFLINE','Firebase unreachable · controls disabled');
    return;
  }
  if(!authed){
    showAlert('offline','SELF DESTRUCT SYSTEM DAMAGED — OFFLINE','Authentication pending/failed');
    return;
  }
  // Sticky access-denied while operator capability probe fails
  if(deniedSticky && !operatorCapable){
    showAlert('access','ACCESS DENIED — NOT OPERATOR','Waiting for operator provisioning');
    return;
  }
  clearAlert();
}

/* ----- init (public-only readers, NO root read) ----- */
let app, db, auth, root, secRef, probeRef;
(async function init(){
  try{
    app = initializeApp(firebaseConfig);
    auth = getAuth(app);
    await signInAnonymously(auth);
    onAuthStateChanged(auth, u=>{ authed=!!u; if(authed) startProbe(); recomputeAlert(); });

    db    = getDatabase(app);
    root  = ref(db,'selfDestruct');
    secRef= child(root,'security');
    probeRef = child(root,'updateProbe'); // canary

    // connection
    onValue(ref(db,'.info/connected'), s=>{ connected=(s.val()===true); recomputeAlert(); });

    // try to seed public keys; if denied, keep deniedSticky=true
    update(root, { status:'IDLE', since:Date.now(), logPublic:[], debug:true }).catch(()=>{ deniedSticky=true; });

    // public listeners
    const pub=(k,cb)=> onValue(child(root,k), snap=>{ cb(snap.val()); if(k==='status') bootOK=true; render(); recomputeAlert(); }, ()=>{ /* ignore */ });
    pub('status',     v=> publicState.status=v||'IDLE');
    pub('since',      v=> publicState.since=v||0);
    pub('startAt',    v=> publicState.startAt=v||null);
    pub('durationMs', v=> publicState.durationMs=v||0);
    pub('armedAt',    v=> publicState.armedAt=v||null);
    pub('logPublic',  v=> publicState.logPublic=Array.isArray(v)?v:[]);
    pub('debug',      v=> DEBUG_FLAG=!!v);

    // security
    onValue(secRef, snap=>{ const v=snap.val()||{}; lockoutUntil=v.lockoutUntil||0; lockoutReason=v.lockoutReason||'LOCKOUT'; recomputeAlert(); });

  }catch(err){
    console.error('[init error]',err);
    connected=false; authed=false; bootOK=false; recomputeAlert();
  }
})();

/* ----- operator capability canary ----- */
async function canaryWrite(){
  if(!probeRef) return;
  try{
    await update(probeRef, { t: Date.now() }); // only operator can write here
    operatorCapable=true;
    deniedSticky=false;
  }catch(e){
    // permission_denied → stay sticky
    operatorCapable=false;
    deniedSticky=true;
  }finally{
    recomputeAlert();
  }
}
function startProbe(){
  if(probeTimer) return;
  probeTimer = setInterval(canaryWrite, 5000);
  canaryWrite();
}

/* ----- DevTools lockout (disabled when debug=true) ----- */
let dtStrikes=0, dtTimer=null;
const devtoolsLikely=()=>{ const T=140; return (window.outerWidth-window.innerWidth>T)||(window.outerHeight-window.innerHeight>T); };
function enterLockout(reason){
  lockoutReason=reason||'Security cooldown';
  lockoutUntil=now()+5*60*1000;
  recomputeAlert();
  if(secRef) update(secRef,{lockoutUntil,lockoutReason}).catch(()=>{});
}
function checkDev(){ if(DEBUG_FLAG) return; if(devtoolsLikely()){ dtStrikes++; clearTimeout(dtTimer); dtTimer=setTimeout(()=>dtStrikes=0,5000); if(dtStrikes>=2) enterLockout('Developer tools opened'); } }
setInterval(checkDev,1200);
window.addEventListener('resize',checkDev);
window.addEventListener('keydown',e=>{ if(((e.ctrlKey||e.metaKey)&&e.shiftKey&&(e.key==='I'||e.key==='J'||e.key==='C'))||e.key==='F12') checkDev(); });

/* ----- soft countdown tick ----- */
setInterval(()=>{ if(publicState.status==='COUNTDOWN') render(); }, 250);
</script>
